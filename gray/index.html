<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <link rel="icon" href="ptrk2.gif" type="image/gif">
  <title>sadness.online/gray</title>
</head>

<body>
  <div class="wrapper">
    <canvas resize></canvas>
  </div>

  <style>
    body {
      margin: 0;
      overflow: hidden;
    }

    canvas {
      height: 100vh;
      width: 100vw;
    }
  </style>


  <script>

    const canvas = document.querySelector('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    window.addEventListener('load', () =>
      requestAnimationFrame(() =>
        draw(ctx, {
          hueIncrement: .1,
          lineWidth: 10,
          fromX: 0,
          fromY: 0,
          hue: 1,
          direction: true,
        })
      )
    )

    // -----

    function handleResize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      ctx.lineWidth = 10;
    }

    function draw(ctx, config) {

      const {
        hueIncrement,
        lineWidth,
        fromX,
        fromY,
        hue,
        direction,
      } = config;

      ctx.strokeStyle = `hsl(0, 0%, ${hue}%)`;
      ctx.lineWidth = lineWidth;

      ctx.beginPath();
      // start from
      ctx.moveTo(fromX, fromY);
      // go to
      ctx.lineTo(fromX, fromY + 100);
      ctx.stroke();

      requestAnimationFrame(() =>
        draw(ctx, stepConfig({ ...config }))
      );
    }

    function stepConfig({ hueIncrement, lineWidth, fromX, fromY, hue, direction }) {

      const newCoords = getCoords(fromX, fromY)
      const newDirection = getDirection(hue, direction);
      const newHue = getHue(newDirection, hueIncrement, hue);

      return {
        hueIncrement,
        lineWidth,
        fromX: newCoords.fromX,
        fromY: newCoords.fromY,
        direction: newDirection,
        hue: newHue,
      }
    }

    function getCoords(fromX, fromY) {

      if (fromY >= canvas.height || fromY >= window.innerHeight) {
        fromX = 0;
        fromY = 0;
      } else if (fromX >= canvas.width) {
        fromX = 0;
        fromY += 100;
      } else {
        fromX += 10
      }

      return { fromX, fromY };
    }

    function getHue(direction, hueIncrement, hue) {
      return direction ? hue + hueIncrement : hue - hueIncrement;
    }

    function getDirection(hue, direction) {
      return hue >= 90 || hue <= 0 ? !direction : direction;
    }


  </script>

  <style>
    html,
    body {
      margin: 0;
      display: flex;
      justify-content: center;
    }

    .wrapper {
      margin: 0 auto;
      height: 100%;
      width: 100%;
    }
  </style>

</body>

</html>